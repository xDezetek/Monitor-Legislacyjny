<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <title>Monitor legislacyjny - RzƒÖd Rzeczypospolitej Polskiej</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="≈öled≈∫ projekty ustaw i uchwa≈Ç, monitoruj konsultacje spo≈Çeczne oraz analizuj wp≈Çyw regulacji legislacyjnych." />
  <style>
    :root {
      --primary: #0052ad;     /* Niebieski gov.pl */
      --secondary: #005eb8;
      --success: #00a651;
      --warning: #f9a825;
      --danger: #da0017;
      --bg: #ffffff;
      --fg: #1a1a1a;
      --muted: #666666;
      --border: #ccc;
      --light-bg: #f5f5f5;
      --focus: #ffbf47;
    }
    
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }
    
    body {
      font-family: "Arial", sans-serif;
      color: var(--fg);
      background: var(--bg);
      line-height: 1.5;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    
    a { color: var(--primary); text-decoration: underline; }
    a:visited { color: #551a8b; }
    a:focus, button:focus, input:focus, select:focus { outline: 3px solid var(--focus); outline-offset: 2px; }
    
    /* Gov.pl-style header */
    header {
      background: var(--primary);
      color: white;
      padding: 0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .header-top {
      background: var(--primary);
      padding: 8px 0;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    
    .header-top-links {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 16px;
      display: flex;
      gap: 16px;
      font-size: 0.85rem;
      align-items: center;
      justify-content: center;
    }
    
    .header-top-links a { color: white; text-decoration: none; }
    .header-top-links a:hover { text-decoration: underline; }
    
    /* Page-level container (keep page content in its original flow) */
    .container { max-width: 1200px; padding: 0 16px; }
    /* Header-only centered container to move top area without affecting main content */
    .header-container { max-width: 1200px; margin: 0 auto; padding: 0 16px; }
    
    .header-main {
      padding: 16px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }
    
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      color: white;
    }
    
    .brand svg {
      width: 40px;
      height: 40px;
      fill: white;
    }
    
    .brand h1 {
      font-size: 1.3rem;
      margin: 0;
      font-weight: 600;
    }
    
    .search-box {
      display: flex;
      align-items: center;
      background: white;
      border-radius: 4px;
      padding: 6px 12px;
      gap: 8px;
      min-width: 300px;
    }
    
    .search-box input {
      border: none;
      padding: 6px;
      font-size: 0.95rem;
      flex: 1;
      outline: none;
    }
    
    .search-box button {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary);
      font-size: 1.2rem;
    }
    
    /* Navigation */
    nav.main-nav {
      background: #f5f5f5;
      border-bottom: 1px solid var(--border);
    }
    
    nav.main-nav ul {
      list-style: none;
      margin: 0;
      padding: 0;
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
    }
    
    nav.main-nav li {
      border-right: 1px solid var(--border);
    }
    
    nav.main-nav li:last-child { border-right: none; }
    
    nav.main-nav a {
      display: block;
      padding: 12px 16px;
      text-decoration: none;
      color: var(--fg);
      font-size: 0.95rem;
      border-bottom: 3px solid transparent;
    }
    
    nav.main-nav a:hover {
      background: #efefef;
      border-bottom-color: var(--primary);
    }
    
    nav.main-nav a.active {
      color: var(--primary);
      font-weight: 600;
      border-bottom-color: var(--primary);
    }
    
    main { 
      padding: 24px 0 80px; 
      background: white;
      flex: 1 0 auto; 
      max-width: 1200px; 
      margin: 0 auto; 
      width: 100%; 
      padding-left: 16px;
      padding-right: 16px;
    }


    .grid { display: grid; grid-template-columns: 1fr 260px; gap: 20px; }
    
    .card {
      padding-bottom: 16px;
      background: white;
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }
    
    .card h2 { margin-top: 0; font-size: 1.3rem; color: var(--fg); }
    .card h3 { margin-top: 16px; font-size: 1.1rem; color: var(--fg); }
    
    .filters {
      display: grid;
      grid-template-columns: 140px 140px 1fr 100px;
      gap: 12px;
      margin-bottom: 16px;
      padding: 12px;
      background: var(--light-bg);
      border-radius: 4px;
    }
    
    .filters .control {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    
    .filters label { font-weight: 600; font-size: 0.9rem; }
    .filters select, .filters input {
      padding: 8px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 0.95rem;
    }
    
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 16px 0;
      padding: 12px;
      background: var(--light-bg);
      border-radius: 4px;
    }
    
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border: 1px solid var(--border);
      background: white;
      border-radius: 4px;
      font-size: 0.9rem;
    }
    
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      display: inline-block;
    }
    
    .dot.pre { background: #9c27b0; }
    .dot.consult { background: #ff9800; }
    .dot.gov { background: #1976d2; }
    .dot.sejm { background: var(--primary); }
    .dot.senat { background: #7b1fa2; }
    .dot.prez { background: #00695c; }
    .dot.pub { background: var(--success); }
    
    .train-board { display: grid; gap: 20px; }

    /* Full-bleed middle section (legislative) */
    #legislative.full-bleed {
      width: 100vw;
      margin-left: calc(50% - 50vw);
      margin-right: calc(50% - 50vw);
      padding: 24px 20px;
      background: var(--light-bg);
      border-radius: 0;
      box-shadow: none;
    }
    
    .train-line {
      border: 2px solid var(--primary);
      border-radius: 4px;
      padding: 12px;
      background: var(--light-bg);
      margin-bottom: 12px;
    }
    
    .train-line h3 {
      margin: 0 0 10px;
      font-size: 0.95rem;
      color: var(--primary);
      font-weight: 600;
    }
    
    .wagons { display: flex; gap: 12px; overflow-x: auto; padding: 6px 2px; justify-content: center; }
    
    .wagon {
      min-width: 260px;
      background: white;
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 10px;
      flex-shrink: 0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }
    
    .wagon .title { font-weight: 600; font-size: 0.9rem; margin-bottom: 4px; }
    .wagon .meta { font-size: 0.8rem; color: var(--muted); margin-bottom: 6px; }
    
    .wagon .progress {
      height: 6px;
      background: #e0e0e0;
      border-radius: 3px;
      margin: 10px 0;
      overflow: hidden;
    }
    
    .wagon .progress .bar {
      height: 100%;
      background: var(--primary);
      width: 0%;
      transition: width 0.3s ease;
    }
    
    .wagon .actions {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    
    .btn {
      border: 1px solid var(--border);
      background: white;
      padding: 6px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      text-decoration: none;
      display: inline-block;
      transition: background 0.2s;
    }
    
    .btn:hover { background: var(--light-bg); }
    
    .btn.primary {
      background: var(--primary);
      color: white;
      border: none;
    }
    
    .btn.primary:hover { background: var(--secondary); }
    
    .feed { display: grid; gap: 12px; }
    
    .feed-item {
      background: white;
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 12px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    
    .feed-item .title { font-weight: 600; color: var(--fg); }
    .feed-item .time { font-size: 0.85rem; color: var(--muted); margin-top: 4px; }
    
    .impact-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .impact-card { background: white; border: 1px solid var(--border); border-radius: 4px; padding: 12px; }
    .impact-card h4 { margin: 0 0 8px; font-size: 0.95rem; }
    
    .impact-meter {
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
      margin: 6px 0;
    }
    
    .impact-meter .mbar {
      height: 100%;
      background: linear-gradient(90deg, var(--success), var(--warning), var(--danger));
      width: 0%;
      transition: width 0.3s ease;
    }
    
    .impact-note { font-size: 0.85rem; color: var(--muted); margin-top: 6px; }
    
    .simple-language textarea {
      width: 100%;
      min-height: 110px;
      padding: 10px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-family: Arial, sans-serif;
      font-size: 0.95rem;
    }
    
    .simple-language .out {
      background: var(--light-bg);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 12px;
      margin-top: 12px;
      min-height: 100px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    
    aside.card h2 { font-size: 1.1rem; }
    
    footer {
      background: #555;
      color: white;
      border-top: 4px solid var(--primary);
      padding: 24px 0;
      margin-top: 40px;
      flex-shrink: 0;
      display: flex;
      justify-content: center;
    }

    footer .container { 
      max-width: 1200px; 
      width: 100%; 
      padding-left: 16px; 
      padding-right: 16px; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      text-align: center; 
    }
    
    footer a { color: #ffcc00; text-decoration: none; }
    footer a:hover { text-decoration: underline; }
    
    .footer-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
    
    .footer-section h3 { font-size: 1rem; margin-top: 0; }
    .footer-section ul { list-style: none; margin: 0; padding: 0; }
    .footer-section li { margin: 6px 0; }
    
    .footer-info { text-align: center; padding-top: 16px; border-top: 1px solid rgba(255,255,255,0.2); font-size: 0.85rem; }
    
    @media (max-width: 980px) {
      .grid { grid-template-columns: 1fr; }
      .impact-grid { grid-template-columns: 1fr; }
      .footer-grid { grid-template-columns: 1fr; }
      .search-box { min-width: 200px; }
      .wagons { overflow-x: scroll; }
      .filters { grid-template-columns: 1fr; }
      .header-main { flex-direction: column; gap: 12px; }
    }
    
    .sr-only { position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden; }
  </style>
</head>
<body>
  <div class="header-top">
      <div class="header-container header-top-links">
      <a href="https://www.gov.pl">Gov.pl</a>
      <a href="#help">Pomoc</a>
      <a href="#accessibility">Dostƒôpno≈õƒá</a>
      <a href="#contact">Kontakt</a>
    </div>
  </div>

  <header role="banner">
      <div class="header-container">
      <div class="header-main">
        <a href="#" class="brand">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M5 3h14a2 2 0 0 1 2 2v3H3V5a2 2 0 0 1 2-2zm-2 8h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-8zm5 2v6h2v-6H8zm4 0v6h2v-6h-2zm4 0v6h2v-6h-2z"/>
          </svg>
          <h1>Monitor legislacyjny</h1>
        </a>
        <div class="search-box">
          <input type="search" placeholder="Wyszukaj projekt ustawy..." id="globalSearch" />
          <button type="submit" aria-label="Szukaj">üîç</button>
        </div>
      </div>
    </div>
  </header>

  <nav class="main-nav" role="navigation" aria-label="G≈Ç√≥wna nawigacja">
      <div class="header-container">
      <ul>
        <li><a href="#legislative" class="nav-link active" data-section="legislative">Projekty ustaw</a></li>
        <li><a href="#consultations" class="nav-link" data-section="consultations">Konsultacje</a></li>
        <li><a href="#tracking" class="nav-link" data-section="tracking">≈öledzenie zmian</a></li>
        <li><a href="#impact" class="nav-link" data-section="impact">Analiza wp≈Çywu</a></li>
        <li><a href="#alerts" class="nav-link" data-section="alerts">Alerty</a></li>
        <li><a href="#simple" class="nav-link" data-section="simple">Prosty jƒôzyk</a></li>
        <li><a href="#access" class="nav-link" data-section="access">Dostƒôp u≈ºytkownik√≥w</a></li>
      </ul>
    </div>
  </nav>

  <main id="content" class="container">
    <div class="grid">
      <section class="card" id="legislative" aria-labelledby="legislative-title">
        <h2 id="legislative-title">Projekty ustaw i uchwa≈Ç</h2>
        <p>Wizualny harmonogram legislacyjny - ≈õled≈∫ projekty na ka≈ºdym etapie prac legislacyjnych, od prekonsultacji do publikacji.</p>

        <div class="filters" aria-label="Filtry">
          <div class="control">
            <label for="priority">Temat</label>
            <select id="priority">
              <option value="all">Wszystkie tematy</option>
              <option value="AI">Sztuczna inteligencja</option>
              <option value="Cybersecurity">Cyberbezpiecze≈Ñstwo</option>
              <option value="Data">Dane i prywatno≈õƒá</option>
            </select>
          </div>
          <div class="control">
            <label for="stage">Etap procesu</label>
            <select id="stage">
              <option value="all">Wszystkie</option>
              <option value="prekonsultacje">Prekonsultacje</option>
              <option value="konsultacje">Konsultacje spo≈Çeczne</option>
              <option value="rzƒÖd">RzƒÖd</option>
              <option value="sejm">Sejm</option>
              <option value="senat">Senat</option>
              <option value="prezydent">Prezydent</option>
              <option value="publikacja">Publikacja (Dz.U.)</option>
            </select>
          </div>
          <div class="control" style="min-width:280px;">
            <label for="search">Wyszukaj projekt</label>
            <input id="search" type="search" placeholder="np. Ustawa o sztucznej inteligencji" />
          </div>
          <button class="btn primary" id="resetFilters">Wyczy≈õƒá filtry</button>
        </div>

        <div class="legend" aria-label="Legenda etap√≥w">
          <span class="badge"><span class="dot pre"></span> Prekonsultacje</span>
          <span class="badge"><span class="dot consult"></span> Konsultacje</span>
          <span class="badge"><span class="dot gov"></span> RzƒÖd</span>
          <span class="badge"><span class="dot sejm"></span> Sejm</span>
          <span class="badge"><span class="dot senat"></span> Senat</span>
          <span class="badge"><span class="dot prez"></span> Prezydent</span>
          <span class="badge"><span class="dot pub"></span> Publikacja</span>
        </div>

        <div id="trainBoard" class="train-board" aria-live="polite">
          <!-- Rendered by JS -->
        </div>
      </section>

      <section class="card" id="access" aria-labelledby="access-title">
      <h2 id="access-title">Dostƒôp dla r√≥≈ºnych u≈ºytkownik√≥w</h2>
           <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
        <div style="background: var(--light-bg); border: 1px solid var(--border); border-radius: 4px; padding: 12px;">
          <h3 style="margin-top: 0;">üëî Urzƒôdnicy</h3>
          <ul style="font-size: 0.9rem; margin: 0; padding-left: 16px;">
            <li>Pe≈Çny dostƒôp do projekt√≥w</li>
            <li>Edycja dokument√≥w</li>
            <li>ZarzƒÖdzanie konsultacjami</li>
            <li>Raporty i analizy</li>
          </ul>
        </div>
        <div style="background: var(--light-bg); border: 1px solid var(--border); border-radius: 4px; padding: 12px;">
          <h3 style="margin-top: 0;">üë§ Obywatele</h3>
          <ul style="font-size: 0.9rem; margin: 0; padding-left: 16px;">
            <li>PrzeglƒÖdanie projekt√≥w</li>
            <li>≈öledzenie zmian</li>
            <li>Dodawanie uwag</li>
            <li>Prosty jƒôzyk</li>
          </ul>
        </div>
      </div>
      <div>
        <label for="userRole"><strong>Twoja rola:</strong></label>
        <select id="userRole">
          <option value="citizen">Obywatel</option>
          <option value="official">Urzƒôdnik</option>
        </select>
      </div>
    </section>

      <aside class="card" aria-label="Szybkie akcje">
        <h2>Szybkie akcje</h2>
        <div class="feed" id="quickActions">
          <div class="feed-item" id="quickAddItem">
            <div class="title">‚ûï Nowy projekt</div>
            <div class="time">Dodaj nowy projekt do ≈õledzenia</div>
            <button id="addProjectBtn" class="btn primary" style="width: 100%; margin-top: 6px;">Dodaj</button>
          </div>
          <div class="feed-item">
            <div class="title">üîî Konfiguruj alerty</div>
            <div class="time">Otrzymuj powiadomienia</div>
            <button class="btn" style="width: 100%; margin-top: 6px;">Ustawienia</button>
          </div>
          <div class="feed-item" id="exportItem">
            <div class="title">üìä Eksportuj raport</div>
            <div class="time">PDF, CSV, Excel</div>
            <button class="btn" style="width: 100%; margin-top: 6px;">Eksport</button>
          </div>
        </div>
        <hr />
        <h2>Aktualno≈õci</h2>
        <div class="feed" id="dailySummary">
          <!-- Rendered by JS -->
        </div>
      </aside>
    </div>

    <section class="card" id="consultations" aria-labelledby="consultations-title">
      <h2 id="consultations-title">Konsultacje spo≈Çeczne</h2>
      <p>Monitoruj etapy prekonsultacji i konsultacji. Partycypuj w procesie stanowienia prawa poprzez dodawanie opinii.</p>
      <div class="feed" id="consultationsFeed">
        <!-- Rendered by JS -->
      </div>
    </section>

    <section class="card" id="tracking" aria-labelledby="tracking-title">
      <h2 id="tracking-title">Integracja i ≈õledzenie zmian</h2>
      <p>Centralne miejsce do monitorowania wszystkich zmian legislacyjnych, aktualizacji tekst√≥w i dokument√≥w.</p>
      <h3>Zmiany w ostatnich 7 dniach:</h3>
      <div class="feed" id="changeLog">
        <!-- Rendered by JS -->
      </div>
      <div style="margin-top: 16px;">
        <button class="btn primary" id="viewFullChangelog">Pe≈Çny dziennik zmian</button>
        <button class="btn" id="compareVersions">Por√≥wnaj wersje</button>
      </div>
    </section>

    <section class="card" id="tracking-console" aria-labelledby="tracking-console-title">
      <h2 id="tracking-console-title">Szybkie ≈õledzenie nowych projekt√≥w</h2>
      <p>Automatyczne powiadomienia o nowych projektach na wczesnym etapie prac legislacyjnych, od fazy prekonsultacji.</p>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
        <div>
          <label for="trackingScope"><strong>≈öledzenie:</strong></label>
          <select id="trackingScope">
            <option value="all">Wszystkie projekty</option>
            <option value="early">Wczesne etapy (prekonsultacje)</option>
            <option value="consultation">Konsultacje spo≈Çeczne</option>
            <option value="active">Aktywne prace</option>
          </select>
        </div>
        <div>
          <label for="notificationMethod"><strong>Powiadomienia:</strong></label>
          <select id="notificationMethod">
            <option value="none">Brak</option>
            <option value="email">E-mail</option>
            <option value="sms">SMS</option>
            <option value="both">E-mail + SMS</option>
          </select>
        </div>
      </div>
      <button class="btn primary" id="saveTracking">Zapisz ustawienia</button>
      <div id="trackingStatus" style="margin-top: 12px; padding: 10px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px; color: #155724; display: none;">
        ‚úì Ustawienia ≈õledzenia zosta≈Çy zapisane
      </div>
    </section>

    <section class="card" id="impact" aria-labelledby="impact-title">
      <h2 id="impact-title">Analiza wp≈Çywu regulacji</h2>
      <p>PrzeglƒÖd szacowanych skutk√≥w dla finans√≥w publicznych, proces√≥w operacyjnych i spo≈Çecze≈Ñstwa.</p>
      <div class="impact-grid" id="impactGrid">
        <!-- Rendered by JS -->
      </div>
    </section>

    <section class="card" id="alerts" aria-labelledby="alerts-title">
      <h2 id="alerts-title">Alerty i raporty o zmianach</h2>
      <p>Otrzymuj raporty i alerty o istotnych zmianach legislacyjnych. Zwiƒôksza transparentno≈õƒá i pozwala na skuteczne zarzƒÖdzanie ryzykiem.</p>
      <div class="feed" id="alertsFeed">
        <!-- Rendered by JS -->
      </div>
    </section>

    <section class="card" id="simple" aria-labelledby="simple-title">
      <h2 id="simple-title">Prosty jƒôzyk dla obywateli</h2>
      <p>Narzƒôdzie do t≈Çumaczenia skomplikowanych tekst√≥w urzƒôdowych na prosty, zrozumia≈Çy dla wszystkich jƒôzyk.</p>
      <div class="simple-language">
        <label for="plainInput"><strong>Wklej fragment dokumentu</strong></label>
        <textarea id="plainInput" placeholder="Wklej z≈Ço≈ºony, formalny akapit..."></textarea>
        <button class="btn primary" id="simplifyBtn">Upro≈õƒá jƒôzyk</button>
        <div class="out" id="plainOutput" aria-live="polite"></div>
      </div>
    </section>

    
  </main>

  <footer role="contentinfo">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-section">
          <h3>Informacje</h3>
          <ul>
            <li><a href="#about">O serwisie</a></li>
            <li><a href="#faq">Pytania i odpowiedzi</a></li>
            <li><a href="#guide">Instrukcja u≈ºytkownika</a></li>
            <li><a href="#api">API</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Bezpiecze≈Ñstwo i prywatno≈õƒá</h3>
          <ul>
            <li><a href="#privacy">Polityka prywatno≈õci</a></li>
            <li><a href="#cookies">Polityka cookies</a></li>
            <li><a href="#terms">Warunki u≈ºytkowania</a></li>
            <li><a href="#accessibility">Dostƒôpno≈õƒá</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Kontakt i pomoc</h3>
          <ul>
            <li><a href="mailto:info@monitor-legislacyjny.gov.pl">info@monitor-legislacyjny.gov.pl</a></li>
            <li><a href="tel:+48223284567">+48 22 328 45 67</a></li>
            <li><a href="#support">Wsparcie techniczne</a></li>
            <li><a href="#report">Zg≈Ço≈õ b≈ÇƒÖd</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-info">
        <p>¬© 2025 Kancelaria Prezesa RzƒÖdu. Wszystkie prawa zastrze≈ºone.<br>
        Serwis dostƒôpny 24/7 | Kompatybilny z WCAG 2.1 AA | <a href="#gdpr">RODO</a></p>
      </div>
    </div>
  </footer>

  <script>
    // Dane przyk≈Çadowe (zastƒÖpiƒá integracjƒÖ API RCL/Sejm/BIP)
    const projects = [
      {
        id: "AI-001",
        title: "Ustawa o sztucznej inteligencji",
        topic: "AI",
        stage: "sejm",
        progressPct: 62,
        owner: "MC",
        nextMilestone: "II czytanie",
        impact: { finance: 55, operations: 40, social: 70 },
        consultations: [
          { phase: "prekonsultacje", from: "2025-02-10", to: "2025-03-01" },
          { phase: "konsultacje", from: "2025-03-15", to: "2025-04-10" },
        ]
      },
      {
        id: "CYB-014",
        title: "Nowelizacja ustawy o krajowym systemie cyberbezpiecze≈Ñstwa",
        topic: "Cybersecurity",
        stage: "rzƒÖd",
        progressPct: 38,
        owner: "KPRM",
        nextMilestone: "Komitet Sta≈Çy RM",
        impact: { finance: 35, operations: 60, social: 45 },
        consultations: [
          { phase: "prekonsultacje", from: "2025-01-20", to: "2025-02-05" },
        ]
      },
      {
        id: "DATA-022",
        title: "Ustawa o ochronie danych w us≈Çugach cyfrowych",
        topic: "Data",
        stage: "prekonsultacje",
        progressPct: 12,
        owner: "UODO",
        nextMilestone: "Publikacja za≈Ço≈ºe≈Ñ",
        impact: { finance: 25, operations: 30, social: 50 },
        consultations: []
      },
      {
        id: "AI-009",
        title: "Zmiana ustawy ‚Äì prawo zam√≥wie≈Ñ publicznych (AI w zam√≥wieniach)",
        topic: "AI",
        stage: "senat",
        progressPct: 78,
        owner: "UZP",
        nextMilestone: "Posiedzenie Senatu",
        impact: { finance: 40, operations: 55, social: 35 },
        consultations: [
          { phase: "konsultacje", from: "2025-04-01", to: "2025-04-20" },
        ]
      },
      {
        id: "CYB-020",
        title: "RozporzƒÖdzenie o incydentach w sektorze publicznym",
        topic: "Cybersecurity",
        stage: "publikacja",
        progressPct: 100,
        owner: "ABW",
        nextMilestone: "Wej≈õcie w ≈ºycie",
        impact: { finance: 30, operations: 65, social: 30 },
        consultations: []
      }
    ];

    const stagesOrder = ["prekonsultacje","konsultacje","rzƒÖd","sejm","senat","prezydent","publikacja"];

    const lines = [
      { key: "AI", label: "Temat: Sztuczna inteligencja" },
      { key: "Cybersecurity", label: "Temat: Cyberbezpiecze≈Ñstwo" },
      { key: "Data", label: "Temat: Dane i prywatno≈õƒá" },
    ];

    const alerts = [
      { title: "Zmiana terminu konsultacji: Ustawa o AI", time: "Dzi≈õ, 10:15", detail: "Przed≈Çu≈ºono konsultacje do 10.04.2025" },
      { title: "Aktualizacja tekstu: KSC", time: "Wczoraj, 16:02", detail: "Dodano rozdzia≈Ç dot. wymog√≥w raportowania" },
      { title: "Publikacja: Incydenty w sektorze publicznym", time: "Wczoraj, 09:30", detail: "RozporzƒÖdzenie opublikowane w Dz.U." },
    ];

    const consultations = [
      { title: "Ustawa o AI ‚Äì konsultacje", from: "2025-03-15", to: "2025-04-10", link: "#", owner: "MC", status: "aktywne" },
      { title: "Prawo zam√≥wie≈Ñ publicznych ‚Äì AI", from: "2025-04-01", to: "2025-04-20", link: "#", owner: "UZP", status: "nadchodzƒÖce" },
      { title: "Ochrona danych ‚Äì prekonsultacje", from: "2025-02-10", to: "2025-03-01", link: "#", owner: "UODO", status: "zako≈Ñczone" },
    ];

    // Dziennik zmian - historia aktualizacji
    const changes = [
      { date: "2025-12-05", project: "Ustawa o AI", change: "Aktualizacja tekstu - dodano rozdzia≈Ç o przejrzysto≈õci", type: "update" },
      { date: "2025-12-04", project: "KSC", change: "Zmiana terminu: sesja przesuniƒôta na 10.12", type: "schedule" },
      { date: "2025-12-03", project: "Prawo zam√≥wie≈Ñ publicznych", change: "Rozpoczƒôcie konsultacji spo≈Çecznych", type: "consultation" },
      { date: "2025-12-02", project: "Ustawa o AI", change: "Nowy projekt dodany - faza prekonsultacji", type: "new" },
      { date: "2025-12-01", project: "Ochrona danych", change: "Opublikowany raport OSR", type: "report" },
      { date: "2025-11-30", project: "Cyberbezpiecze≈Ñstwo", change: "Zatwierdzono przez Radƒô Ministr√≥w", type: "approved" },
      { date: "2025-11-29", project: "Ustawa o AI", change: "Dodano opiniƒô Sejmu", type: "opinion" },
    ];

    // Szablony raport√≥w
    const reportTemplates = [
      { name: "Raport tygodniowy", period: "7 dni" },
      { name: "Raport miesiƒôczny", period: "30 dni" },
      { name: "Raport tematyczny", period: "custom" },
      { name: "Raport do zarzƒÖdzania ryzykiem", period: "all" },
    ];

    // Render helpers
    function formatStageTag(stage) {
      const map = {
        "prekonsultacje": { label: "Prekonsultacje", cls: "pre" },
        "konsultacje": { label: "Konsultacje spo≈Çeczne", cls: "consult" },
        "rzƒÖd": { label: "RzƒÖd", cls: "gov" },
        "sejm": { label: "Sejm", cls: "sejm" },
        "senat": { label: "Senat", cls: "senat" },
        "prezydent": { label: "Prezydent", cls: "prez" },
        "publikacja": { label: "Publikacja (Dz.U.)", cls: "pub" },
      };
      const m = map[stage] || { label: stage, cls: "gov" };
      return `<span class="badge"><span class="dot ${m.cls}"></span>${m.label}</span>`;
    }

    function renderTrainBoard() {
      const board = document.getElementById("trainBoard");
      board.innerHTML = "";
      const topicFilter = document.getElementById("priority").value;
      const stageFilter = document.getElementById("stage").value;
      const query = document.getElementById("search").value.trim().toLowerCase();

      lines.forEach(line => {
        // Filter by line topic, then apply additional filters
        const items = projects.filter(p =>
          p.topic === line.key && // Must match the line's topic
          (topicFilter === "all" || p.topic === topicFilter) &&
          (stageFilter === "all" || p.stage === stageFilter) &&
          (query === "" || p.title.toLowerCase().includes(query) || p.id.toLowerCase().includes(query))
        );
        if (items.length === 0) return;

        const lineEl = document.createElement("div");
        lineEl.className = "train-line";
        lineEl.innerHTML = `<h3>${line.label}</h3><div class="wagons" role="list" aria-label="Wagony projekt√≥w"></div>`;
        const wagonsEl = lineEl.querySelector(".wagons");
        // sort by stage order
        items.sort((a,b) => stagesOrder.indexOf(a.stage) - stagesOrder.indexOf(b.stage));

        items.forEach(p => {
          const w = document.createElement("div");
          w.className = "wagon";
          w.setAttribute("role","listitem");
          w.innerHTML = `
            <div class="title">${p.title}</div>
            <div class="meta">ID: ${p.id} ‚Ä¢ W≈Ça≈õciciel: ${p.owner}</div>
            <div class="status">${formatStageTag(p.stage)} ‚Ä¢ Nastƒôpny krok: <span class="status-tag">${p.nextMilestone}</span></div>
            <div class="progress"><div class="bar" style="width:${p.progressPct}%"></div></div>
            <div class="actions">
              <button class="btn" aria-label="Szczeg√≥≈Çy projektu" onclick="openProject('${p.id}')">Szczeg√≥≈Çy</button>
              <button class="btn" aria-label="Dodaj alert" onclick="addAlert('${p.id}')">Alert</button>
              <button class="btn" aria-label="Dodaj do raportu" onclick="addToReport('${p.id}')">Do raportu</button>
              <button class="btn" aria-label="Poka≈º konsultacje" onclick="openConsultations('${p.id}')">Konsultacje</button>
              <button class="btn" aria-label="Analiza wp≈Çywu" onclick="openImpact('${p.id}')">Impact</button>
            </div>
          `;
          wagonsEl.appendChild(w);
        });
        board.appendChild(lineEl);
      });

      if (!board.innerHTML) {
        board.innerHTML = `<p>Brak projekt√≥w dla wybranych filtr√≥w.</p>`;
      }
    }

    function renderSummary() {
      const box = document.getElementById("dailySummary");
      box.innerHTML = "";
      projects.slice(0, 3).forEach(p => {
        const item = document.createElement("div");
        item.className = "feed-item";
        item.innerHTML = `
          <div class="title">${p.title}</div>
          <div class="time">Etap: ${p.stage} ‚Ä¢ Nastƒôpny krok: ${p.nextMilestone}</div>
        `;
        box.appendChild(item);
      });
    }

    function renderConsultations() {
      const box = document.getElementById("consultationsFeed");
      box.innerHTML = "";
      consultations.forEach(c => {
        const item = document.createElement("div");
        item.className = "feed-item";
        item.innerHTML = `
          <div class="title">${c.title}</div>
          <div class="time">${c.status} ‚Ä¢ ${c.from} ‚Üí ${c.to} ‚Ä¢ Organizator: ${c.owner}</div>
          <div>Link: <a href="${c.link}" aria-label="Przejd≈∫ do konsultacji">Strona konsultacji</a></div>
          <div style="margin-top:6px;">
            <button class="btn" onclick="subscribeConsultation('${c.title}')">Subskrybuj</button>
            <button class="btn" onclick="commentConsultation('${c.title}')">Dodaj opiniƒô</button>
          </div>
        `;
        box.appendChild(item);
      });
    }

    function renderImpactGrid() {
      const grid = document.getElementById("impactGrid");
      grid.innerHTML = "";
      projects.forEach(p => {
        const card = document.createElement("div");
        card.className = "impact-card";
        card.innerHTML = `
          <h4>${p.title}</h4>
          <div class="impact-meter" aria-label="Wska≈∫nik wp≈Çywu finansowego">
            <div class="mbar" style="width:${p.impact.finance}%"></div>
          </div>
          <div class="impact-note">Finanse publiczne: ${p.impact.finance}% (koszty/korzy≈õci, bud≈ºet wdro≈ºeniowy)</div>

          <div class="impact-meter" aria-label="Wska≈∫nik wp≈Çywu operacyjnego" style="margin-top:8px;">
            <div class="mbar" style="width:${p.impact.operations}%"></div>
          </div>
          <div class="impact-note">Operacje: ${p.impact.operations}% (zmiany proces√≥w, obciƒÖ≈ºenie urzƒôd√≥w)</div>

          <div class="impact-meter" aria-label="Wska≈∫nik wp≈Çywu spo≈Çecznego" style="margin-top:8px;">
            <div class="mbar" style="width:${p.impact.social}%"></div>
          </div>
          <div class="impact-note">Spo≈Çeczne: ${p.impact.social}% (dostƒôpno≈õƒá, zaufanie, ryzyko wykluczenia)</div>

          <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
            <button class="btn" onclick="openOsr('${p.id}')">OSR / szczeg√≥≈Çy</button>
            <button class="btn" onclick="simulateRisk('${p.id}')">Symuluj ryzyka</button>
            <button class="btn" onclick="addToReport('${p.id}')">Dodaj do raportu</button>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    function renderAlerts() {
      const box = document.getElementById("alertsFeed");
      box.innerHTML = "";
      alerts.forEach(a => {
        const item = document.createElement("div");
        item.className = "feed-item";
        item.innerHTML = `
          <div class="title">${a.title}</div>
          <div class="time">${a.time}</div>
          <div>${a.detail}</div>
        `;
        box.appendChild(item);
      });
    }

    // Render dziennika zmian
    function renderChangeLog() {
      const box = document.getElementById("changeLog");
      box.innerHTML = "";
      const recentChanges = changes.slice(0, 5);
      recentChanges.forEach(c => {
        const item = document.createElement("div");
        item.className = "feed-item";
        const typeLabel = {
          "new": "üÜï Nowy projekt",
          "update": "üìù Aktualizacja",
          "consultation": "üí¨ Konsultacje",
          "schedule": "üìÖ Zmiana harmonogramu",
          "report": "üìä Raport",
          "approved": "‚úÖ Zatwierdzone",
          "opinion": "üí≠ Opinia"
        }[c.type] || "üìå Zmiana";
        item.innerHTML = `
          <div class="title">${typeLabel} - ${c.project}</div>
          <div class="time">${c.date}</div>
          <div>${c.change}</div>
        `;
        box.appendChild(item);
      });
    }

    // Funkcjonalno≈õƒá ≈õledzenia zmian na wczesnych etapach
    function initializeTracking() {
      const trackingScope = document.getElementById("trackingScope");
      const notificationMethod = document.getElementById("notificationMethod");
      const saveBtn = document.getElementById("saveTracking");
      const trackingStatus = document.getElementById("trackingStatus");

      if (!saveBtn) return;

      saveBtn.addEventListener("click", () => {
        const scope = trackingScope ? trackingScope.value : 'all';
        const method = notificationMethod ? notificationMethod.value : 'none';
        
        // Filtruj projekty na wczesnych etapach
        let earlyProjects = projects;
        if (scope === "early") {
          earlyProjects = projects.filter(p => p.stage === "prekonsultacje");
        } else if (scope === "consultation") {
          earlyProjects = projects.filter(p => ["prekonsultacje", "konsultacje"].includes(p.stage));
        } else if (scope === "active") {
          earlyProjects = projects.filter(p => !["publikacja"].includes(p.stage));
        }

        // Zapisz do localStorage
        localStorage.setItem("trackingScope", scope);
        localStorage.setItem("notificationMethod", method);
        localStorage.setItem("trackedProjects", JSON.stringify(earlyProjects.map(p => p.id)));

        // Poka≈º potwierdzenie
        trackingStatus.style.display = "block";
        setTimeout(() => {
          trackingStatus.style.display = "none";
        }, 3000);

        console.log(`≈öledzenie ${scope} - powiadomienia: ${method}`);
      });
    }

    // Funkcjonalno≈õƒá dostƒôpu u≈ºytkownik√≥w
    function initializeUserAccess() {
      const userRole = document.getElementById("userRole");
      if (!userRole) return;

      function applyRole(role) {
        // Dostosuj widoczno≈õƒá funkcji w zale≈ºno≈õci od roli
        const officialFeatures = ["viewFullChangelog", "compareVersions", "configureAlerts", "addProjectBtn"];
        const citizenFeatures = ["simplifyBtn"];

        officialFeatures.forEach(id => {
          const el = document.getElementById(id);
          if (el) {
            el.style.display = role === "official" ? "inline-block" : "none";
          }
        });

        // wire add button to enforce role on click
        const addBtn = document.getElementById('addProjectBtn');
        if (addBtn) {
          addBtn.onclick = () => {
            if (role !== 'official') { alert('Dodawanie projekt√≥w jest dostƒôpne tylko dla urzƒôdnik√≥w.'); return; }
            addProject();
          };
        }

        // Hide or show quick-action feed items depending on role
        const quickAddItem = document.getElementById('quickAddItem');
        const exportItem = document.getElementById('exportItem');
        if (quickAddItem) quickAddItem.style.display = role === 'official' ? '' : 'none';
        if (exportItem) exportItem.style.display = role === 'official' ? '' : 'none';
      }

      userRole.addEventListener("change", (e) => {
        const role = e.target.value;
        applyRole(role);
        // Zapisz preferencjƒô
        localStorage.setItem("userRole", role);
        console.log(`Rola u≈ºytkownika zmieniona na: ${role}`);
      });

      // run once on load to apply saved role
      const initRole = localStorage.getItem('userRole') || userRole.value;
      userRole.value = initRole;
      applyRole(initRole);
    }

    // Por√≥wnanie wersji dokument√≥w
    function initializeVersionComparison() {
      const compareBtn = document.getElementById("compareVersions");
      if (!compareBtn) return;

      compareBtn.addEventListener("click", () => {
        alert("Por√≥wnanie wersji:\n\n" +
          "Wersja 1 (2025-12-01): Tekst 1000 s≈Ç√≥w\n" +
          "Wersja 2 (2025-12-05): Tekst 1150 s≈Ç√≥w\n\n" +
          "Zmiany:\n" +
          "- Dodano 150 s≈Ç√≥w\n" +
          "- Zmieniono 8 paragraf√≥w\n" +
          "- Usuniƒôto 1 rozdzia≈Ç");
      });
    }

    // Pe≈Çny dziennik zmian
    function initializeFullChangelog() {
      const viewBtn = document.getElementById("viewFullChangelog");
      if (!viewBtn) return;

      viewBtn.addEventListener("click", () => {
        let log = "PE≈ÅNY DZIENNIK ZMIAN\n\n";
        changes.forEach(c => {
          log += `${c.date} - ${c.project}: ${c.change}\n`;
        });
        alert(log);
      });
    }

    // Actions (placeholdery)
    function openProject(id) { alert("Szczeg√≥≈Çy projektu: " + id); }
    function addAlert(id) { alert("Dodano alert dla projektu: " + id); }
    function addToReport(id) { alert("Dodano do raportu: " + id); }
    function openConsultations(id) {
      const p = projects.find(x => x.id === id);
      if (!p || !p.consultations || p.consultations.length === 0) { alert("Brak konsultacji dla: " + id); return; }
      const info = p.consultations.map(c => `${c.phase}: ${c.from} ‚Üí ${c.to}`).join("\n");
      alert("Konsultacje dla " + p.title + ":\n" + info);
    }
    function openImpact(id) { alert("Analiza wp≈Çywu dla: " + id); }
    function subscribeConsultation(title) { alert("Subskrypcja konsultacji: " + title); }
    function commentConsultation(title) { alert("Dodaj opiniƒô do: " + title); }
    function openOsr(id) { alert("OSR dla projektu: " + id); }
    function simulateRisk(id) { alert("Symulacja ryzyk dla: " + id); }

    // Add project (restricted to officials via UI and role check)
    function addProject() {
      const role = (document.getElementById('userRole') || {}).value || localStorage.getItem('userRole');
      if (role !== 'official') { alert('Dodawanie projekt√≥w jest dostƒôpne tylko dla urzƒôdnik√≥w.'); return; }
      const title = prompt('Nazwa projektu ustaw (kr√≥tka):');
      if (!title) return;
      const id = 'NEW-' + Math.random().toString(36).slice(2,8).toUpperCase();
      const newP = { id, title, topic: 'AI', stage: 'prekonsultacje', progressPct: 5, owner: 'Anon', nextMilestone: 'Rejestracja', impact: { finance: 0, operations: 0, social: 0 }, consultations: [] };
      projects.unshift(newP);
      renderTrainBoard();
      renderSummary();
      renderImpactGrid();
      alert('Projekt dodany: ' + title);
    }

    // Simple language
    function simplifyText(input) {
      if (!input || input.trim().length === 0) return "Wklej tekst, a upro≈õcimy go.";
      // Prosty algorytm zastƒôpujƒÖcy ≈ºargon i dodajƒÖcy wyja≈õnienie skutk√≥w.
      let t = input;
      const map = [
        { from: /niniejsze rozporzƒÖdzenie/gmi, to: "ten dokument" },
        { from: /podmiot zobowiƒÖzany/gmi, to: "instytucja lub firma, kt√≥ra musi to zrobiƒá" },
        { from: /niezw≈Çocznie/gmi, to: "tak szybko, jak to mo≈ºliwe" },
        { from: /w≈Ça≈õciwy organ/gmi, to: "odpowiedni urzƒÖd" },
        { from: /regulamin/gmi, to: "zasady" },
        { from: /uchyla siƒô/gmi, to: "przestaje obowiƒÖzywaƒá" },
        { from: /wchodzi w ≈ºycie/gmi, to: "zaczyna obowiƒÖzywaƒá" },
        { from: /akt normatywny/gmi, to: "przepis" },
      ];
      map.forEach(r => { t = t.replace(r.from, r.to); });
      const effects = [];
      if (/op≈Çaty|koszt/i.test(input)) effects.push("Mo≈ºe zmieniƒá op≈Çaty lub koszty.");
      if (/termin|deadline|dni/i.test(input)) effects.push("Wprowadza konkretne terminy wykonania.");
      if (/obowiƒÖzek|zobowiƒÖzany/i.test(input)) effects.push("Nak≈Çada obowiƒÖzki na wskazane podmioty.");
      if (/kary|sankcje|mandat/i.test(input)) effects.push("Przewiduje sankcje za niewykonanie.");
      const summary = effects.length ? "\n\nSkutki prawne (prostym jƒôzykiem):\n- " + effects.join("\n- ") : "";
      return t + summary;
    }

    // Events
    document.getElementById("priority").addEventListener("change", renderTrainBoard);
    document.getElementById("stage").addEventListener("change", renderTrainBoard);
    document.getElementById("search").addEventListener("input", renderTrainBoard);
    document.getElementById("resetFilters").addEventListener("click", () => {
      document.getElementById("priority").value = "all";
      document.getElementById("stage").value = "all";
      document.getElementById("search").value = "";
      renderTrainBoard();
    });
    document.getElementById("simplifyBtn").addEventListener("click", () => {
      const input = document.getElementById("plainInput").value;
      const out = simplifyText(input);
      document.getElementById("plainOutput").textContent = out;
    });

    // Navigation tracking
    // Single-view navigation: show only the selected view
    const sectionIds = ['legislative','consultations','tracking','tracking-console','impact','alerts','simple','access'];

    function showSection(id) {
      // hide all top-level sections
      sectionIds.forEach(sid => {
        const el = document.getElementById(sid);
        if (el) el.style.display = 'none';
      });

      // show the requested main section
      const el = document.getElementById(id);
      if (el) el.style.display = '';

      // show tracking-console only when 'tracking' is selected
      if (id === 'tracking') {
        const tc = document.getElementById('tracking-console');
        if (tc) tc.style.display = '';
      } else {
        const tc = document.getElementById('tracking-console');
        if (tc) tc.style.display = 'none';
      }

      // update nav active class
      document.querySelectorAll('.nav-link').forEach(l => l.classList.toggle('active', l.dataset.section === id));

      // handle full-bleed and aside visibility
      const grid = document.querySelector('.grid');
      const aside = grid ? grid.querySelector('aside.card') : null;

      // legislative uses full-bleed; other views do not
      const leg = document.getElementById('legislative');
      if (id === 'legislative') {
        if (leg) leg.classList.add('full-bleed');
      } else {
        if (leg) leg.classList.remove('full-bleed');
      }

      // Show the aside ONLY on the 'access' page; otherwise hide it
      if (aside) {
        if (id === 'access') {
          aside.style.display = '';
          if (grid) grid.style.gridTemplateColumns = '1fr';
        } else {
          aside.style.display = 'none';
          if (grid) grid.style.gridTemplateColumns = '1fr';
        }
      }

      // Ensure wagons are centered in legislative view (CSS also helps)
      const wagons = document.querySelectorAll('.wagons');
      wagons.forEach(w => w.style.justifyContent = (id === 'legislative') ? 'center' : 'flex-start');

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    document.querySelectorAll('.nav-link').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const id = this.dataset.section;
        showSection(id);
      });
    });

    // Global search
    document.getElementById("globalSearch").addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        const query = e.target.value.toLowerCase();
        document.getElementById("search").value = query;
        // ensure legislative view is visible
        if (typeof showSection === 'function') showSection('legislative');
        renderTrainBoard();
        e.target.value = "";
        document.getElementById("legislative").scrollIntoView({ behavior: "smooth" });
      }
    });

    // Initial render
    renderTrainBoard();
    renderSummary();
    renderConsultations();
    renderImpactGrid();
    renderAlerts();
    renderChangeLog();
    
    // Inicjalizuj funkcjonalno≈õci
    initializeTracking();
    initializeUserAccess();
    initializeVersionComparison();
    initializeFullChangelog();

    // Show default view (legislative) in single-view mode
    if (typeof showSection === 'function') showSection('legislative');
  </script>
</body>
</html>
